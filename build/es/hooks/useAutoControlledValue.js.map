{"version":3,"file":"useAutoControlledValue.js","sources":["../../../src/react/hooks/useAutoControlledValue.ts"],"sourcesContent":["import * as React from 'react';\n\n\nexport type UseAutoControlledValueConfig<State> = {\n  /** Control the Props at any Render, use this to get external controls */\n  prop?: State;\n\n  /** Initial Value */\n  defaultProp?: State;\n};\n\nexport function useAutoControlledValue<State>(initialState: State, config?: UseAutoControlledValueConfig<State>): [\n  State,\n  React.Dispatch<React.SetStateAction<State>>,\n  React.Dispatch<React.SetStateAction<State>>,\n  () => void\n] {\n\n  const { prop, defaultProp } = config ?? {};\n  const [ state, setState ] = React.useState(prop === undefined\n    ? (defaultProp === undefined ? initialState : defaultProp)\n    : prop);\n\n  // Counterpart to the `static getDerivedStateFromProps` method, but for one key only.\n  // When `prop` has changed since last render, update `state` with the `prop`'s value.\n  // https://reactjs.org/docs/hooks-faq.html#how-do-i-implement-getderivedstatefromprops\n  const getDerivedStateFromProps = React.useCallback(\n    () => {\n      if (prop === undefined || prop === state) {\n        return;\n      }\n\n      setState(prop);\n    },\n    [ state, prop, setState ]\n  );\n\n\n  // Attempt to modify the `state` value internally.\n  // When `prop` has already been provided, defer to it and don't update `state`.\n  const trySetState: React.Dispatch<React.SetStateAction<State>> = React.useCallback(\n    (newState) => {\n      if (prop !== undefined) {\n        return;\n      }\n\n      setState(newState);\n    },\n    [ prop, setState ]\n  );\n\n  return [\n    prop === undefined ? state : prop,\n    trySetState,\n    setState,\n    getDerivedStateFromProps\n  ];\n}\n"],"names":["React.useState","React.useCallback"],"mappings":";;;;;;SAWgB,sBAAsB,CAAQ,YAAmB,EAAE,MAA4C;IAOvG,IAAA,KAAwB,MAAM,aAAN,MAAM,cAAN,MAAM,GAAI,EAAE,EAAlC,IAAI,UAAA,EAAE,WAAW,iBAAiB,CAAC;IACrC,IAAA,KAAsBA,cAAc,CAAC,IAAI,KAAK,SAAS;WACxD,WAAW,KAAK,SAAS,GAAG,YAAY,GAAG,WAAW;UACvD,IAAI,CAAC,EAFD,KAAK,QAAA,EAAE,QAAQ,QAEd,CAAC;;;;IAKV,IAAM,wBAAwB,GAAGC,iBAAiB,CAChD;QACE,IAAI,IAAI,KAAK,SAAS,IAAI,IAAI,KAAK,KAAK,EAAE;YACxC,OAAO;SACR;QAED,QAAQ,CAAC,IAAI,CAAC,CAAC;KAChB,EACD,CAAE,KAAK,EAAE,IAAI,EAAE,QAAQ,CAAE,CAC1B,CAAC;;;IAKF,IAAM,WAAW,GAAgDA,iBAAiB,CAChF,UAAC,QAAQ;QACP,IAAI,IAAI,KAAK,SAAS,EAAE;YACtB,OAAO;SACR;QAED,QAAQ,CAAC,QAAQ,CAAC,CAAC;KACpB,EACD,CAAE,IAAI,EAAE,QAAQ,CAAE,CACnB,CAAC;IAEF,OAAO;QACL,IAAI,KAAK,SAAS,GAAG,KAAK,GAAG,IAAI;QACjC,WAAW;QACX,QAAQ;QACR,wBAAwB;KACzB,CAAC;AACJ;;;;"}