{"version":3,"file":"DropdownMenu.js","sources":["../../../../src/react/collections/DropdownMenu/DropdownMenu.tsx"],"sourcesContent":["import * as React from 'react';\nimport clsx from 'clsx';\n\nimport {\n  childrenUtils\n} from '@appbuckets/react-ui-core';\nimport { Button } from '../../elements/Button';\n\nimport {\n  useElementType\n} from '../../lib';\n\nimport { useAutoControlledValue } from '../../hooks/useAutoControlledValue';\n\nimport { Popup } from '../../modules/Popup';\n\nimport MenuItem from '../Menu/MenuItem';\nimport { MenuItemProps } from '../Menu/MenuItem.types';\n\nimport { DropdownMenuProps } from './DropdownMenu.types';\n\n\n/* --------\n * Component Declare\n * -------- */\ntype DropdownMenuComponent = React.FunctionComponent<DropdownMenuProps>;\n\n\n/* --------\n * Component Render\n * -------- */\nconst DropdownMenu: DropdownMenuComponent = (props) => {\n\n  const {\n    as,\n    basic,\n    children,\n    className,\n    closeOnItemClicked,\n    content,\n    defaultOpen: userDefinedDefaultOpen,\n    inverted,\n    items,\n    onClose,\n    onItemClick,\n    onOpen,\n    openOn,\n    open       : userDefinedOpen,\n    position,\n    trigger,\n    ...rest\n  } = props;\n\n  const ElementType = useElementType(DropdownMenu, props);\n\n  const [ open, trySetOpen ] = useAutoControlledValue(false, {\n    defaultProp: userDefinedDefaultOpen,\n    prop       : userDefinedOpen\n  });\n\n  const classes = clsx(\n    'dropdown',\n    className\n  );\n\n\n  // ----\n  // Handlers\n  // ----\n  const handleMenuOpen = (e: React.MouseEvent<HTMLElement>) => {\n    if (typeof onOpen === 'function') {\n      onOpen(e, { ...props, open: true });\n    }\n\n    trySetOpen(true);\n  };\n\n  const handleMenuClose = (e: React.MouseEvent<HTMLElement>) => {\n    if (typeof onClose === 'function') {\n      onClose(e, { ...props, open: false });\n    }\n\n    trySetOpen(false);\n  };\n\n\n  // ----\n  // Trigger Element\n  // ----\n  const triggerElement = Button.create(trigger, {\n    autoGenerateKey: false,\n    overrideProps  : (defaultProps) => ({\n      onClick: (event, buttonProps) => {\n        /** Call user defined handler */\n        if (defaultProps.onClick) {\n          defaultProps.onClick(event, buttonProps);\n        }\n\n        /** On trigger click toggle menu */\n        if (open) {\n          handleMenuClose(event);\n        }\n        else {\n          handleMenuOpen(event);\n        }\n      }\n    })\n  }) ?? undefined;\n\n\n  // ----\n  // Component Render\n  // ----\n  return (\n    <Popup\n      className={'dropdown-container'}\n      portalProps={{\n        open,\n        closeOnDocumentClick: true\n      }}\n      basic={basic}\n      inverted={inverted}\n      trigger={triggerElement}\n      openOn={openOn}\n      position={position}\n      onOpen={handleMenuOpen}\n      onClose={handleMenuClose}\n      content={(\n        <ElementType {...rest} className={classes}>\n          {\n            Array.isArray(items)\n              ? items.map((item) => (\n                MenuItem.create(item, {\n                  autoGenerateKey: true,\n                  overrideProps  : ({ onClick, ...itemRest }) => ({\n                    onClick: (e: React.MouseEvent<HTMLElement>, itemProps: MenuItemProps) => {\n                      /** Call defined itemClick handler */\n                      if (typeof onItemClick === 'function') {\n                        onItemClick(e, itemProps);\n                      }\n\n                      /** Call menu item click handler */\n                      if (onClick) {\n                        onClick(e, itemProps);\n                      }\n\n                      /** Check if must close the menu */\n                      if (closeOnItemClicked) {\n                        handleMenuClose(e);\n                      }\n                    },\n                    ...itemRest\n                  })\n                })\n              ))\n              : childrenUtils.isNil(children) ? content : children\n          }\n        </ElementType>\n      )}\n    />\n  );\n\n};\n\nDropdownMenu.displayName = 'DropdownMenu';\n\nDropdownMenu.defaultProps = {\n  basic             : false,\n  closeOnItemClicked: true,\n  inverted          : false,\n  openOn            : [ 'click' ],\n  position          : 'bottom right'\n};\n\nexport default DropdownMenu;\n"],"names":["useElementType","useAutoControlledValue","clsx","React.createElement","childrenUtils"],"mappings":"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"}