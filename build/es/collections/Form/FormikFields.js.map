{"version":3,"file":"FormikFields.js","sources":["../../../../src/react/collections/Form/FormikFields.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport { Checkbox, CheckboxProps } from '../../elements/Checkbox';\nimport { DayPicker, DayPickerProps, ParsableDate } from '../../elements/DayPicker';\nimport { Input, InputProps } from '../../elements/Input';\nimport { MultiSelect, Select, SelectMultiProps, SelectOption, SelectProps } from '../../elements/Select';\n\nimport { SharedComponentStateProps } from '../../generic';\n\nimport withFormikField from './lib/withFormikField';\nimport { FormikFieldComponentProps, FormikFieldComponentRenderProps } from './lib/withFormikField.types';\n\n\n/* --------\n * Internal Hooks\n * -------- */\nfunction useFormikFieldState<P extends { [key: string]: any }>(\n  props: React.PropsWithChildren<FormikFieldComponentRenderProps<P, any>>\n) {\n  return React.useMemo<Partial<SharedComponentStateProps> & { disabled: boolean }>(\n    () => ({\n      danger  : !!(props.meta.touched && props.state.danger) || !!(props.rest.danger),\n      success : !!(props.meta.touched && props.state.success) || !!(props.rest.success),\n      warning : !!(props.meta.touched && props.state.warning) || !!(props.rest.warning),\n      disabled: !!(props.state.isSubmitting || props.rest.disabled)\n    }),\n    [\n      props.meta.touched,\n      props.state.danger,\n      props.rest.danger,\n      props.state.success,\n      props.rest.success,\n      props.state.warning,\n      props.rest.warning,\n      props.state.isSubmitting,\n      props.rest.disabled\n    ]\n  );\n}\n\n\n/* --------\n * Checkbox Wrapped Component\n * -------- */\nexport const FormikCheckbox = withFormikField<CheckboxProps, boolean>({\n  Component: function FormikCheckboxComponent(props) {\n    const stateProps = useFormikFieldState(props);\n\n    const {\n      value,\n      ...rest\n    } = props.rest;\n\n    return (\n      <Checkbox\n        {...rest}\n        {...stateProps}\n        hint={props.state.message}\n        checked={!!value}\n      />\n    );\n  },\n  onChange : (formik, event, props) => {\n    formik.setFieldValue(props.name, !!props.checked, true);\n  }\n});\n\n\n/* --------\n * DayPicker Wrapped Component\n * -------- */\nexport const FormikDayPicker = withFormikField<DayPickerProps<ParsableDate>, number | null>({\n  Component: function FormikDayPickerComponent(props) {\n    const stateProps = useFormikFieldState(props);\n\n    const {\n      value,\n      onChange,\n      onDayChange: userDefinedDayChangeHandler,\n      timestamp,\n      ...rest\n    } = props.rest;\n\n    const handleDayChange = React.useCallback(\n      (nothing: null, componentProps: DayPickerProps) => {\n        onChange(nothing, componentProps);\n        if (userDefinedDayChangeHandler) {\n          userDefinedDayChangeHandler(nothing, componentProps);\n        }\n      },\n      [ onChange, userDefinedDayChangeHandler ]\n    );\n\n    return (\n      <DayPicker\n        {...rest}\n        {...stateProps}\n        date={value}\n        onDayChange={handleDayChange}\n      />\n    );\n  },\n  onChange : (formik, event, props) => {\n    formik.setFieldValue(props.name, props.timestamp, true);\n  }\n});\n\n\n/* --------\n * Input Wrapped Component\n * -------- */\nexport const FormikInput = withFormikField<InputProps, string | number>({\n  Component         : function FormikInputComponent(props) {\n    const stateProps = useFormikFieldState(props);\n    return (\n      <Input\n        {...props.rest}\n        {...stateProps}\n        hint={props.state.message}\n      />\n    );\n  },\n  setTouchedOnChange: false\n});\n\n\n/* --------\n * Time Wrapped Input Component\n * -------- */\nexport const FormikTime = withFormikField<InputProps, number | null, string>({\n  Component: function FormikTimeInputComponent(props) {\n    const stateProps = useFormikFieldState(props);\n\n    return (\n      <Input\n        {...props.rest}\n        {...stateProps}\n        hint={props.state.message}\n        type={'time'}\n      />\n    );\n  },\n\n  onChange: ((formik, event, props) => {\n    if (typeof props.value !== 'string' || !props.value.length) {\n      formik.setFieldValue(props.name, null);\n      return;\n    }\n\n    const [ hours, minutes ] = props.value.split(':');\n\n    formik.setFieldValue(props.name, (+hours * 3600000) + (+minutes * 60000));\n  }),\n\n  computeValue: ((value) => {\n    if (typeof value !== 'number') {\n      return '';\n    }\n\n    const minutes = (value % 3600000) / 60000;\n    const hours = Math.trunc((value - minutes) / 3600000);\n\n    return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}`;\n  })\n});\n\n\n/* --------\n * Wrapped Select Component\n * -------- */\nexport const FormikSelect = <Option extends SelectOption>(\n  wrapperProps: React.PropsWithChildren<FormikFieldComponentProps<SelectProps<Option>>>\n) => (\n  withFormikField<SelectProps<Option>, Option | null>({\n    Component: function FormikSelectComponent(props) {\n      const stateProps = useFormikFieldState(props);\n\n      return (\n        <Select\n          {...props.rest}\n          {...stateProps}\n          hint={props.state.message}\n        />\n      );\n    },\n\n    onChange: (formik, event, props) => {\n      formik.setFieldValue(props.name, props.value);\n    },\n\n    computeValue: (value, props) => {\n      if (!value) {\n        return null;\n      }\n\n      return props.options.find((option) => {\n        /** Get the Option Value */\n        const optionValue = props.getOptionValue ? props.getOptionValue(option) : option?.value ?? option;\n        /** Compare Option Value with Selected One */\n        if (typeof value === 'object' && value !== null && props.getOptionValue) {\n          return props.getOptionValue(value) === optionValue;\n        }\n        return value === optionValue;\n      }) ?? null;\n    }\n  })(wrapperProps)\n);\n\nexport const FormikMultiSelect = <Option extends SelectOption>(\n  wrapperProps: React.PropsWithChildren<FormikFieldComponentProps<SelectMultiProps<Option>>>\n) => (\n  withFormikField<SelectMultiProps<Option>, Option[] | null>({\n    Component: function FormikSelectComponent(props) {\n      const stateProps = useFormikFieldState(props);\n\n      return (\n        <MultiSelect\n          {...props.rest}\n          {...stateProps}\n          hint={props.state.message}\n        />\n      );\n    },\n\n    onChange: (formik, event, props) => {\n      formik.setFieldValue(props.name, props.value);\n    },\n\n    computeValue: (values, props) => {\n      /** Transform Value using getOptionValue props function if exists */\n      if (!Array.isArray(values)) {\n        return [];\n      }\n\n      return props.options.filter((option) => {\n        /** Get the Option Value */\n        const optionValue = props.getOptionValue ? props.getOptionValue(option) : option?.value ?? option;\n        /** If value is included in values then return true */\n        return !!values.find((value) => {\n          if (typeof value === 'object' && value !== null && props.getOptionValue) {\n            return props.getOptionValue(value) === optionValue;\n          }\n          return value === optionValue;\n        });\n      });\n    }\n  })(wrapperProps)\n);\n"],"names":["React.useMemo","React.createElement","React.useCallback","MultiSelect"],"mappings":"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"}