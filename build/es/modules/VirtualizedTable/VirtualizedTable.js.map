{"version":3,"file":"VirtualizedTable.js","sources":["../../../../src/react/modules/VirtualizedTable/VirtualizedTable.tsx"],"sourcesContent":["import * as React from 'react';\nimport clsx from 'clsx';\nimport { RxTableComponents } from '../../collections/RxTable';\nimport { RxTableError, RxTableLoader } from '../../collections/RxTable/RxTableDefaultComponents';\n\nimport { AnyObject } from '../../generic';\n\nimport { useRxTableFactory } from '../../collections/RxTable/RxTable.factory';\nimport {\n  VirtualizedTableContext,\n  VirtualizedTableProvider\n} from './VirtualizedTable.context';\n\nimport { VirtualizedTableProps } from './VirtualizedTable.types';\nimport { VirtualizedTableBody } from './VirtualizedTableBody';\nimport {\n  VirtualizedTableBodyCell,\n  VirtualizedTableBodyRow,\n  VirtualizedTableFilterCell, VirtualizedTableHeaderCell,\n  VirtualizedTableNoContent\n} from './VirtualizedTableDefaultComponents';\nimport { VirtualizedTableHeader } from './VirtualizedTableHeader';\n\n\n/* --------\n * Component Declare\n * -------- */\ntype VirtualizedTableComponent<Data> = React.FunctionComponent<VirtualizedTableProps<Data>>;\n\n\n/* --------\n * Component Render\n * -------- */\nconst VirtualizedTable = <Data extends AnyObject>(\n  props: React.PropsWithChildren<VirtualizedTableProps<Data>>\n): React.FunctionComponentElement<VirtualizedTableProps<Data>> => {\n\n  const {\n    // Virtualized Table Props\n    columns,\n    Components           : userDefinedComponents,\n    data,\n    defaultData,\n    defaultLoading       : userDefinedDefaultLoading,\n    defaultReverseSorting: userDefinedDefaultReverseSorting,\n    defaultSort          : userDefinedDefaultSort,\n    disableHeader,\n    filterLogic,\n    filterRowHeight      : userDefinedFilterRowHeight,\n    headerHeight         : userDefinedHeaderHeight,\n    height,\n    onRowClick,\n    onSortChange,\n    reloadDependency,\n    reloadSilently,\n    reverseSorting       : userDefinedReverseSorting,\n    rowHeight,\n    sort                 : userDefinedSort,\n    style,\n    width,\n\n    // Extracted Variable Size List Props\n    direction,\n    itemKey,\n    overscanCount,\n    onItemsRendered,\n    onScroll,\n    useIsScrolling,\n\n    // Remove Children\n    children,\n\n    ...rest\n  } = props;\n\n  /** Use RxTable Factory to get Data and Props */\n  const rxTableProps = useRxTableFactory<Data>({\n    columns,\n    data,\n    defaultData,\n    defaultLoading       : userDefinedDefaultLoading,\n    defaultReverseSorting: userDefinedDefaultReverseSorting,\n    defaultSort          : userDefinedDefaultSort,\n    filterLogic,\n    onRowClick,\n    onSortChange,\n    reloadDependency,\n    reloadSilently,\n    reverseSorting       : userDefinedReverseSorting,\n    sort                 : userDefinedSort\n  });\n\n\n  /* --------\n   * Compute Table Width and Height and Accessor\n   * -------- */\n  const headerHeight = typeof userDefinedHeaderHeight === 'number'\n    ? userDefinedHeaderHeight\n    : typeof rowHeight === 'number'\n      ? rowHeight\n      : 0;\n\n  const filterRowHeight = rxTableProps.hasFilterRow\n    ? typeof userDefinedFilterRowHeight === 'number'\n      ? userDefinedFilterRowHeight\n      : headerHeight\n    : 0;\n\n  const columnsWidthSum = columns.reduce((tot, { width: columnWidth }) => (\n    tot + columnWidth\n  ), 0);\n\n  const effectiveWidth = Math.max(columnsWidthSum, width);\n  const tableBodyHeight = height - (!disableHeader ? headerHeight : 0) - filterRowHeight;\n\n\n  /* --------\n   * Build the Components\n   * -------- */\n  const Components: RxTableComponents<Data> = {\n    Body         : 'div',\n    BodyCell     : VirtualizedTableBodyCell,\n    BodyRow      : VirtualizedTableBodyRow,\n    BodyWrapper  : 'div',\n    Error        : RxTableError,\n    ErrorRow     : 'div',\n    ErrorCell    : 'div',\n    FilterCell   : VirtualizedTableFilterCell,\n    FilterRow    : 'div',\n    Header       : 'div',\n    HeaderCell   : VirtualizedTableHeaderCell,\n    HeaderRow    : 'div',\n    HeaderWrapper: 'div',\n    Loader       : RxTableLoader,\n    LoaderRow    : 'div',\n    LoaderCell   : 'div',\n    NoContent    : VirtualizedTableNoContent,\n    NoContentCell: 'div',\n    NoContentRow : 'div',\n    ...userDefinedComponents\n  };\n\n\n  /* --------\n   * Build Classes\n   * -------- */\n  const wrapperClasses = clsx('virtualized-table');\n\n\n  /* --------\n   * Memoized Properties\n   * -------- */\n  const wrapperStyle = React.useMemo<React.CSSProperties>(\n    () => ({\n      height   : `${height}px`,\n      width    : `${width}px`,\n      overflow : 'auto',\n      maxHeight: '100vh',\n      minHeight: '200px',\n      ...style\n    }),\n    [ height, width, style ]\n  );\n\n\n  /* --------\n   * VirtualList Methods\n   * -------- */\n  const estimatedItemSize = typeof rowHeight === 'number' ? rowHeight : undefined;\n\n  const getRowHeight = React.useCallback(\n    (index: number): number => {\n      if (typeof rowHeight === 'number') {\n        return rowHeight;\n      }\n\n      return rowHeight(index);\n    },\n    [ rowHeight ]\n  );\n\n\n  /* --------\n   * Build the Context\n   * -------- */\n  const virtualizedTableContext: VirtualizedTableContext<Data> = {\n    ...rxTableProps,\n    columns,\n    Components,\n    effectiveWidth,\n    filterRowHeight,\n    headerHeight,\n    height: tableBodyHeight,\n    getRowHeight,\n    width\n  };\n\n\n  /* --------\n   * Component Render\n   * -------- */\n  return (\n    <div\n      className={wrapperClasses}\n      style={wrapperStyle}\n      {...rest}\n    >\n      <VirtualizedTableProvider value={virtualizedTableContext}>\n        {!disableHeader && (\n          <VirtualizedTableHeader />\n        )}\n        <VirtualizedTableBody\n          direction={direction}\n          estimatedItemSize={estimatedItemSize}\n          itemKey={itemKey}\n          overscanCount={overscanCount}\n          onItemsRendered={onItemsRendered}\n          onScroll={onScroll}\n          useIsScrolling={useIsScrolling}\n        />\n      </VirtualizedTableProvider>\n    </div>\n  );\n\n};\n\n(VirtualizedTable as VirtualizedTableComponent<unknown>).displayName = 'VirtualizedTable';\n\n(VirtualizedTable as VirtualizedTableComponent<unknown>).defaultProps = {\n  filterLogic   : 'and',\n  reloadSilently: true\n};\n\nexport default VirtualizedTable;\n"],"names":["useRxTableFactory","VirtualizedTableBodyCell","VirtualizedTableBodyRow","RxTableError","VirtualizedTableFilterCell","VirtualizedTableHeaderCell","RxTableLoader","VirtualizedTableNoContent","clsx","React.useMemo","React.useCallback","React.createElement","VirtualizedTableProvider","VirtualizedTableHeader","VirtualizedTableBody"],"mappings":"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"}