{"version":3,"file":"DropzoneFiles.js","sources":["../../../../../src/react/modules/Dropzone/atoms/DropzoneFiles.tsx"],"sourcesContent":["import * as React from 'react';\nimport prettyBytes from 'pretty-bytes';\n\nimport { useInputValue } from '../../../hooks/useInputValue';\n\nimport Input from '../../../elements/Input/Input';\n\nimport { Item, ItemGroupProps } from '../../../elements/Item';\n\nimport { useDropzone } from '../Dropzone.context';\nimport { DropzoneFile } from '../Dropzone.types';\n\n\n/* --------\n * Internal Component\n * -------- */\nconst DropzoneFileItem: React.FunctionComponent<{ file: DropzoneFile }> = (props) => {\n\n  const {\n    file\n  } = props;\n\n\n  // ----\n  // State and Hook declaration\n  // ----\n  const [ newItemName, handleItemNameChange ] = useInputValue(file.name);\n  const [ isEditing, setIsEditing ] = React.useState(false);\n  const dropzone = useDropzone();\n\n\n  // ----\n  // Remove the isEditing state on upload\n  // ----\n  React.useEffect(\n    () => {\n      if (dropzone.isUploading) {\n        setIsEditing(false);\n      }\n    },\n    [ dropzone.isUploading ]\n  );\n\n\n  // ----\n  // Handlers\n  // ----\n  const handleEditStart = React.useCallback(\n    () => {\n      setIsEditing(true);\n    },\n    [ setIsEditing ]\n  );\n\n  const handleEditEnd = React.useCallback(\n    () => {\n      /** Save the new Item name */\n      dropzone.editFile({\n        ...file,\n        name: newItemName.length ? newItemName : file.name\n      });\n\n      setIsEditing(false);\n    },\n    [\n      dropzone,\n      file,\n      newItemName,\n      setIsEditing\n    ]\n  );\n\n  const handleFileRemove = React.useCallback(\n    () => {\n      dropzone.deleteFile(file);\n    },\n    [ dropzone, file ]\n  );\n\n\n  // ----\n  // Memoized Parts\n  // ----\n  const itemHeader = React.useMemo(\n    () => {\n      if (!isEditing) {\n        return file.name;\n      }\n\n      return (\n        <Input\n          autoFocus\n          selectAllOnClick\n          value={newItemName}\n          onChange={handleItemNameChange}\n          actions={[\n            {\n              key     : 1,\n              disabled: !newItemName,\n              icon    : 'check',\n              success : true,\n              onClick : handleEditEnd\n            }\n          ]}\n        />\n      );\n    },\n    [\n      isEditing,\n      file.name,\n      newItemName,\n      handleItemNameChange,\n      handleEditEnd\n    ]\n  );\n\n\n  // ----\n  // Component Render\n  // ----\n  return (\n    <Item\n      centered\n      loading={file.state.isUploading}\n      disabled={dropzone.isUploading || file.state.success}\n      primary={file.state.isUploading}\n      danger={file.state.error}\n      success={file.state.success}\n      avatar={{\n        icon: file.state.isUploading\n          ? 'sync'\n          : file.state.error\n            ? 'times'\n            : file.state.success\n              ? 'check'\n              : file.icon,\n        type: 'square'\n      }}\n      header={itemHeader}\n      content={!isEditing ? prettyBytes(file.size) : undefined}\n      tools={[\n        dropzone.props.editItemTool && !isEditing && ({\n          ...dropzone.props.editItemTool,\n          key    : 0,\n          onClick: handleEditStart\n        }),\n        dropzone.props.removeItemTool && ({\n          ...dropzone.props.removeItemTool,\n          key    : 1,\n          onClick: handleFileRemove\n        })\n      ]}\n    />\n  );\n};\n\n\n/* --------\n * Component Interfaces\n * -------- */\nexport interface DropzoneFilesProps extends ItemGroupProps {\n\n}\n\n\n/* --------\n * Component Definition\n * -------- */\nconst DropzoneFiles: React.FunctionComponent<DropzoneFilesProps> = () => {\n\n  const dropzone = useDropzone();\n\n  if (!dropzone.files.length) {\n    return null;\n  }\n\n  return (\n    <Item.Group relaxed divided>\n      {dropzone.files.map((file) => (\n        <DropzoneFileItem\n          key={file.id}\n          file={file}\n        />\n      ))}\n    </Item.Group>\n  );\n};\n\nDropzoneFiles.displayName = 'DropzoneFiles';\n\nexport default DropzoneFiles;\n"],"names":["useInputValue","React.useState","useDropzone","React.useEffect","React.useCallback","React.useMemo","React.createElement","prettyBytes"],"mappings":"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"}