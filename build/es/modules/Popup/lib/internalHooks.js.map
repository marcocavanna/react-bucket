{"version":3,"file":"internalHooks.js","sources":["../../../../../src/react/modules/Popup/lib/internalHooks.ts"],"sourcesContent":["import * as React from 'react';\n\nimport { Placement } from '@popperjs/core';\nimport { Modifier, StrictModifierNames } from 'react-popper';\nimport { isRefObject, PortalProps } from '@appbuckets/react-ui-core';\n\nimport { PopupPosition, PopupProps } from '../Popup.types';\n\n\ntype PopperModifiers = Modifier<StrictModifierNames>;\n\n\n/**\n * Return memoized PortalProps using user defined portal props and\n * some other props value\n * @param portalProps User defined PortalProps\n * @param rest All PopupProps\n */\nexport function usePortalProps(portalProps: PortalProps | undefined, rest: PopupProps): PortalProps {\n  return React.useMemo(\n    () => {\n      const memoizedPortalProps: PortalProps = { ...portalProps };\n\n      if (rest.hoverable) {\n        memoizedPortalProps.closeOnPortalMouseLeave = true;\n        memoizedPortalProps.mouseLeaveDelay = 300;\n      }\n\n      if (rest.openOn?.includes('click')) {\n        memoizedPortalProps.openOnTriggerClick = true;\n        memoizedPortalProps.closeOnTriggerClick = true;\n        memoizedPortalProps.closeOnDocumentClick = true;\n      }\n\n      if (rest.openOn?.includes('focus')) {\n        memoizedPortalProps.openOnTriggerFocus = true;\n        memoizedPortalProps.closeOnTriggerBlur = true;\n      }\n\n      if (rest.openOn?.includes('hover')) {\n        memoizedPortalProps.openOnTriggerMouseEnter = true;\n        memoizedPortalProps.closeOnTriggerMouseLeave = true;\n        memoizedPortalProps.mouseLeaveDelay = 70;\n        memoizedPortalProps.mouseEnterDelay = 50;\n      }\n\n      return memoizedPortalProps;\n    },\n    [ portalProps, rest.openOn, rest.hoverable ]\n  );\n}\n\n\nexport function usePopperPlacementMapping(position?: PopupPosition): Placement {\n  return React.useMemo(\n    () => {\n      if (!position) {\n        return 'auto';\n      }\n\n      return {\n        auto: 'auto',\n\n        'top center': 'top',\n        'top left'  : 'top-start',\n        'top right' : 'top-end',\n\n        'bottom center': 'bottom',\n        'bottom left'  : 'bottom-start',\n        'bottom right' : 'bottom-end',\n\n        'right center': 'right',\n        'left center' : 'left'\n      }[position] as Placement;\n    },\n    [ position ]\n  );\n}\n\n\n/**\n * Merge user defined modifiers with default popper modifiers\n *\n * @param defaultModifiers An array of default modifiers\n * @param userDefinedModifiers The user default modifiers\n * @param deps An array of dependencies to append to useMemo\n */\nexport function usePopperModifiers(\n  defaultModifiers: ReadonlyArray<PopperModifiers>,\n  userDefinedModifiers: ReadonlyArray<PopperModifiers>,\n  deps: ReadonlyArray<any>\n): PopperModifiers[] {\n  return React.useMemo(\n    () => {\n\n      if (!userDefinedModifiers) {\n        return defaultModifiers as PopperModifiers[];\n      }\n\n      const mergedPopperModifiers: PopperModifiers[] = [\n        ...userDefinedModifiers\n      ];\n\n      defaultModifiers.forEach((modifier) => {\n        if (!mergedPopperModifiers.find((userModifier) => (\n          userModifier.name === modifier.name\n        ))) {\n          mergedPopperModifiers.push(modifier);\n        }\n      });\n\n      return mergedPopperModifiers;\n    },\n    [\n      defaultModifiers,\n      userDefinedModifiers,\n      deps\n    ]\n  );\n}\n\n\nclass ReferenceProxy {\n\n  constructor(private ref: React.RefObject<HTMLElement>) {\n  }\n\n\n  getBoundingClientRect(): Partial<DOMRect> {\n    return this.ref.current?.getBoundingClientRect() ?? {};\n  }\n\n\n  get clientWidth() {\n    return this.getBoundingClientRect().width;\n  }\n\n\n  get clientHeight() {\n    return this.getBoundingClientRect().height;\n  }\n\n\n  get parentNode() {\n    return this.ref.current?.parentNode;\n  }\n\n}\n\nexport function useReferenceProxy(reference: React.RefObject<HTMLElement> | HTMLElement | null) {\n  return React.useMemo(\n    () => {\n      return new ReferenceProxy(\n        isRefObject(reference) ? reference : { current: reference }\n      ) as unknown as HTMLElement;\n    },\n    [ reference ]\n  );\n}\n"],"names":["React.useMemo"],"mappings":"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"}