{"version":3,"file":"AutoSpacer.js","sources":["../../../../src/react/hoc/AutoSpacer/AutoSpacer.tsx"],"sourcesContent":["import * as React from 'react';\nimport clsx from 'clsx';\n\nimport { AutoSpacerProps, AutoSpacerRenderProps } from './AutoSpacer.types';\n\n\ninterface AutoSpacerState {\n  /** Current Height */\n  height: number;\n\n  /** Current Width */\n  width: number;\n}\n\nexport default class AutoSpacer extends React.Component<AutoSpacerProps, AutoSpacerState> {\n\n\n  /* --------\n   * Define initial State\n   * -------- */\n  state: AutoSpacerState = {\n    height: this.computeHeight(this.props.defaultHeight ?? 0),\n    width : this.computeWidth(this.props.defaultWidth ?? 0)\n  };\n\n\n  /* --------\n   * Define the isMounted state to avoid unnecessary re render\n   * -------- */\n  isComponentMounted = false;\n\n\n  /* --------\n   * Initialize Ref Containers\n   * -------- */\n  containerRef = React.createRef<HTMLDivElement>();\n\n  parentNode: Node & ParentNode | undefined | null = undefined;\n\n\n  /* --------\n   * Component LifeCycle Handlers\n   * -------- */\n  public componentDidMount() {\n    this.isComponentMounted = true;\n    this.parentNode = this.containerRef.current?.parentNode;\n    window.addEventListener('resize', this.recomputeSizing.bind(this));\n    this.recomputeSizing();\n  }\n\n\n  public componentWillUnmount() {\n    this.isComponentMounted = false;\n    this.parentNode = undefined;\n    window.removeEventListener('resize', this.recomputeSizing.bind(this));\n  }\n\n\n  /* --------\n   * Get valid data\n   * -------- */\n  computeHeight(initialHeight: number): number {\n    const {\n      subtractHeight = 0,\n      maximumHeight,\n      minimumHeight = 0\n    } = this.props;\n\n    const subtractedHeight = initialHeight - subtractHeight;\n\n    if (subtractedHeight < minimumHeight) {\n      return minimumHeight;\n    }\n\n    if (typeof maximumHeight === 'number' && subtractedHeight > maximumHeight) {\n      return maximumHeight;\n    }\n\n    return subtractedHeight;\n  }\n\n\n  computeWidth(initialWidth: number): number {\n    const {\n      subtractWidth = 0,\n      maximumWidth,\n      minimumWidth = 0\n    } = this.props;\n\n    const subtractedWidth = initialWidth - subtractWidth;\n\n    if (subtractedWidth < minimumWidth) {\n      return minimumWidth;\n    }\n\n    if (typeof maximumWidth === 'number' && subtractedWidth > maximumWidth) {\n      return maximumWidth;\n    }\n\n    return subtractedWidth;\n  }\n\n\n  /* --------\n   * Resize Callback Function\n   * -------- */\n  recomputeSizing() {\n    /** Avoid recomputing if no node, or if component is not mounted */\n    const { current: container } = this.containerRef;\n\n    if (!container || !this.parentNode) {\n      return;\n    }\n\n    /** Get props */\n    const {\n      disableHeight,\n      disableWidth,\n      onResize\n    } = this.props;\n\n    /** Get current state and container ref */\n    const {\n      height: currHeight,\n      width : currWidth\n    } = this.state;\n\n    /** Get current window dimension */\n    const {\n      innerHeight: windowHeight,\n      innerWidth : windowWidth\n    } = window;\n\n    /** Get Container offset Position */\n    const {\n      top : containerTopPosition,\n      left: containerLeftPosition\n    } = container.getBoundingClientRect();\n\n    /** Get new Size */\n    const nextHeight = disableHeight ? container.clientHeight : this.computeHeight(windowHeight - containerTopPosition);\n    const nextWidth = disableWidth ? container.clientWidth : this.computeWidth(windowWidth - containerLeftPosition);\n\n    /** Check if must update state */\n    if (this.isComponentMounted && ((nextHeight !== currHeight) || (nextWidth !== currWidth))) {\n      this.setState({\n        height: nextHeight,\n        width : nextWidth\n      }, () => {\n        if (typeof onResize === 'function') {\n          onResize({ height: nextHeight, width: nextWidth });\n        }\n      });\n    }\n  }\n\n\n  /* --------\n   * Component Render\n   * -------- */\n  public renderChildren(): React.ReactNode | null {\n    const {\n      children,\n      renderIfInvisible\n    } = this.props;\n\n    const {\n      height,\n      width\n    } = this.state;\n\n    if ((height === 0 || width === 0) && !renderIfInvisible) {\n      return null;\n    }\n\n    if (typeof children === 'function') {\n      return (children as (size: AutoSpacerRenderProps) => React.ReactNode)({ height, width });\n    }\n\n    return children ?? null;\n  }\n\n\n  public render() {\n    const {\n      className,\n      children,\n      disableHeight,\n      disableWidth,\n      style\n    } = this.props;\n\n    const {\n      height,\n      width\n    } = this.state;\n\n    const classes = clsx(\n      {\n        'disabled-height': disableHeight,\n        'disabled-width' : disableWidth\n      },\n      'autospacer',\n      className\n    );\n\n    const divStyle = typeof children !== 'function'\n      ? { ...style, height, width }\n      : { ...style };\n\n    return (\n      <div ref={this.containerRef} className={classes} style={divStyle}>\n        {this.renderChildren()}\n      </div>\n    );\n  }\n}\n"],"names":["__extends","React.createRef","clsx","React.createElement","React.Component"],"mappings":"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"}